---
title: "p8105_hw5_jz3900"
author: "ELisajava"
date: "2024-11-11"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Import necessary libraries
```{r}
library(tidyverse) 
library(broom)
library(ggplot2)
set.seed(1)
```

# Problem 1
```{r}
# Define a function to check for duplicate birthdays in a group
check_duplicate_birthday <- function(n) {
  sampled_birthdays <- sample(1:365, n, replace = TRUE)  # Generate sample birthdays randomly
  any(duplicated(sampled_birthdays))  # Return TRUE if duplicates are found
}

# Set up group sizes and initialize a vector for storing probabilities
group_sizes <- 2:50
probabilities <- numeric(length(group_sizes))

# Simulate the probability of duplicated birthdays for each group size
probabilities <- sapply(group_sizes, function(n) {
  mean(replicate(10000, check_duplicate_birthday(n)))
})

# Prepare data for visualization
results_data <- data.frame(GroupSize = group_sizes, Probability = probabilities)

# Generate the plot
ggplot(results_data, aes(x = GroupSize, y = Probability)) +
  geom_line() +
  geom_point() +
  labs(
    title = "Probability of Shared Birthdays by Group Size",
    x = "Number of People in Group (Group Size)",
    y = "Probability of Shared Birthday",
    caption = "Based on 10,000 simulations per group size"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```
The plot illustrates that as the group size grows, the likelihood of at least two people sharing a birthday rises sharply. With just 23 people in a group, the probability surpasses 50%. As the group size nears 50, the probability approaches certainty 1.00.
